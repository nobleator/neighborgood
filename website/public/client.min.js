var options,results;function getOptions(e){xhr=new XMLHttpRequest,xhr.open("GET","query",!0),xhr.onload=function(){200==xhr.status&&(options=JSON.parse(xhr.responseText),e(options))},xhr.send()}function makeReadable(e){if("rpp"==e)return e.toUpperCase();for(var t="",n=!0,r=0;r<e.length;r++)ch=e.charAt(r),"_"==ch?(t+=" ",n=!0):n?(t+=e.charAt(r).toUpperCase(),n=!1):t+=e.charAt(r);return t}function writeOptions(){getOptions(e=>{var t='<div class="row">';function n(r){if(t+='<div class="subrow"><input type="checkbox" onchange="verifySelection(this);" id="'+r+'">',t+='<label for="'+r+'"class="ck-button">'+makeReadable(r)+"</label></div>",e[r].children.length>0)for(var o in e[r].children)n(e[r].children[o]);return t}for(var r in e)null==e[r].parent&&(t+='<div class="cell">',n(r),t+="</div>");t+="</div>",document.getElementById("criteria-list").innerHTML=t})}function getChecked(){var e={null:[]};for(var t in options)options[t].children.length>0&&(e[t]=[]);for(var t in options)document.getElementById(t).checked?(e[options[t].parent].push(t),options[t].selected=!0):options[t].selected=!1;for(var n in output="",e)for(var r=e[n],o=0;o<r.length-1;o++)for(var i=o+1;i<r.length;i++)output+='<div class="range">',output+='<span class="left">'+makeReadable(r[o])+"</span>",output+='<input type="range" min="-9" max="9" step="1" id="',output+=r[o]+"-"+r[i]+'">',output+='<span class="right">'+makeReadable(r[i])+"</span>",output+="</div>";document.getElementById("weights").innerHTML=output}function verifySelection(e){if(e.checked){!function e(t){null!=t&&(document.getElementById(t).checked=!0,e(options[t].parent))}(e.id),function e(t){for(var n in document.getElementById(t).checked=!0,options[t].children)e(options[t].children[n])}(e.id)}else{if(function e(t){for(var n in document.getElementById(t).checked=!1,options[t].children)e(options[t].children[n])}(e.id),null!=options[e.id].parent){var t=!1,n=options[options[e.id].parent].children;for(var r in n)document.getElementById(n[r]).checked&&(t=!0);t||(document.getElementById(options[e.id].parent).checked=!1)}}}function progressBar(){var e=document.getElementById("progBarInner"),t=0,n=setInterval(function(){t>=100?(document.getElementById("resultsTable").style.visibility="visible",clearInterval(n)):(t++,e.style.width=t+"%")},15)}function getWeights(){document.getElementById("resultsTable").style.visibility="hidden",progressBar();for(var e={},t=document.getElementsByTagName("input"),n=0;n<t.length;n++)"range"==t[n].type.toLowerCase()&&(e[t[n].id]=t[n].value);xhr=new XMLHttpRequest,xhr.open("POST","submit",!0),xhr.setRequestHeader("Content-type","application/json"),xhr.onload=function(){200==xhr.status&&(results=JSON.parse(xhr.responseText),writeResultsTable())};var r={options:options,weights:e};xhr.send(JSON.stringify(r))}function writeResultsTable(){var e="";for(var t in results)e+="<tr>",e+="<td>"+t+"</td>",e+="<td>"+results[t].utility+"</td>",e+="<td>"+results[t].cost+"</td>",e+="</tr>";document.getElementById("resultsTableBody").innerHTML=e,sortTable(1),sortTable(1)}function sortTable(e){var t,n,r,o,i,s,a,l,d=0;for(t=document.getElementById("resultsTable"),r=!0,l="asc";r;){for(r=!1,n=t.getElementsByTagName("TR"),o=1;o<n.length-1;o++)if(a=!1,i=n[o].getElementsByTagName("TD")[e],s=n[o+1].getElementsByTagName("TD")[e],"asc"==l){if(i.innerHTML.toLowerCase()>s.innerHTML.toLowerCase()){a=!0;break}}else if("desc"==l&&i.innerHTML.toLowerCase()<s.innerHTML.toLowerCase()){a=!0;break}a?(n[o].parentNode.insertBefore(n[o+1],n[o]),r=!0,d++):0==d&&"asc"==l&&(l="desc",r=!0)}}function init(){writeOptions(),document.getElementById("submitChecked").addEventListener("click",getChecked,!1),document.getElementById("submitWeights").addEventListener("click",getWeights,!1),document.getElementById("sort0").addEventListener("click",()=>{sortTable(0)},!1),document.getElementById("sort1").addEventListener("click",()=>{sortTable(1)},!1),document.getElementById("sort2").addEventListener("click",()=>{sortTable(2)},!1)}window.addEventListener("load",init,!1);