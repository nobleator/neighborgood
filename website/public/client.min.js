var options,results;function getOptions(e){xhr=new XMLHttpRequest,xhr.open("GET","query",!0),xhr.onload=function(){200==xhr.status&&(options=JSON.parse(xhr.responseText),e(options))},xhr.send()}function writeOptions(){getOptions(e=>{var t="<ul>";function n(o){if(t+='<li><input type="checkbox" onchange="verifySelection(this);" id="'+o+'">'+o+"</li>",e[o].children.length>0){for(var i in t+="<ul>",e[o].children)n(e[o].children[i]);t+="</ul>"}return t}for(var o in e)null==e[o].parent&&n(o);t+="</ul>",document.getElementById("criteria-list").innerHTML=t})}function getChecked(){var e={null:[]};for(var t in options)options[t].children.length>0&&(e[t]=[]);for(var t in options)document.getElementById(t).checked?(e[options[t].parent].push(t),options[t].selected=!0):options[t].selected=!1;for(var n in output="",e)for(var o=e[n],i=0;i<o.length-1;i++)for(var r=i+1;r<o.length;r++)output+="<span>"+o[i]+"</span>",output+='<input type="range" min="-3" max="3" step="1" id="',output+=o[i]+"-"+o[r]+'">',output+="<span>"+o[r]+"</span><br>";document.getElementById("weights").innerHTML=output}function verifySelection(e){if(e.checked){!function e(t){null!=t&&(document.getElementById(t).checked=!0,e(options[t].parent))}(e.id),function e(t){for(var n in document.getElementById(t).checked=!0,options[t].children)e(options[t].children[n])}(e.id)}else{if(function e(t){for(var n in document.getElementById(t).checked=!1,options[t].children)e(options[t].children[n])}(e.id),null!=options[e.id].parent){var t=!1,n=options[options[e.id].parent].children;for(var o in n)document.getElementById(n[o]).checked&&(t=!0);t||(document.getElementById(options[e.id].parent).checked=!1)}}}function getWeights(){for(var e={},t=document.getElementsByTagName("input"),n=0;n<t.length;n++)"range"==t[n].type.toLowerCase()&&(e[t[n].id]=t[n].value);xhr=new XMLHttpRequest,xhr.open("POST","submit",!0),xhr.setRequestHeader("Content-type","application/json"),xhr.onload=function(){200==xhr.status&&(results=JSON.parse(xhr.responseText),writeResultsTable("resultsTableBody"))};var o={options:options,weights:e};xhr.send(JSON.stringify(o))}function writeResultsTable(e){var t="";for(var n in results)t+="<tr>",t+="<td>"+n+"</td>",t+="<td>"+results[n].utility+"</td>",t+="<td>"+results[n].cost+"</td>",t+="</tr>";document.getElementById(e).innerHTML=t}function sortTable(e){var t,n,o,i,r,s,d,l,c=0;for(t=document.getElementById("resultsTable"),o=!0,l="asc";o;){for(o=!1,n=t.getElementsByTagName("TR"),i=1;i<n.length-1;i++)if(d=!1,r=n[i].getElementsByTagName("TD")[e],s=n[i+1].getElementsByTagName("TD")[e],"asc"==l){if(r.innerHTML.toLowerCase()>s.innerHTML.toLowerCase()){d=!0;break}}else if("desc"==l&&r.innerHTML.toLowerCase()<s.innerHTML.toLowerCase()){d=!0;break}d?(n[i].parentNode.insertBefore(n[i+1],n[i]),o=!0,c++):0==c&&"asc"==l&&(l="desc",o=!0)}}function init(){writeOptions(),document.getElementById("submitChecked").addEventListener("click",getChecked,!1),document.getElementById("submitWeights").addEventListener("click",getWeights,!1),document.getElementById("sort0").addEventListener("click",()=>{sortTable(0)},!1),document.getElementById("sort1").addEventListener("click",()=>{sortTable(1)},!1),document.getElementById("sort2").addEventListener("click",()=>{sortTable(2)},!1)}window.addEventListener("load",init,!1);
